<!doctype html>
<html lang="ja">
<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no"/>
  <title>System Typing</title>
  <style>
    body{
      font-family:-apple-system,system-ui,"Segoe UI",Roboto,"Noto Sans JP";
      margin:0;
      background:#050816;
      color:#eef1ff;
      /* スマホでのバウンススクロール防止 */
      overscroll-behavior-y: none;
    }
    main{max-width:980px;margin:0 auto;padding:20px;}
    .panel{
      background:#14183a;
      border:1px solid rgba(255,255,255,.1);
      border-radius:18px;
      padding:18px 18px 22px;
      box-shadow:0 18px 40px rgba(0,0,0,.45);
    }
    h1{font-size:22px;margin:0 0 12px;}
    h1 span{font-size:13px;font-weight:400;opacity:.7;margin-left:8px;}
    .grid{
      display:grid; gap:10px; grid-template-columns:repeat(5,1fr);
    }
    label{font-size:12px;opacity:.9;display:block;margin-bottom:4px;}
    select,input[type=number],button,input[type=text]{
      width:100%; padding:10px; border-radius:12px;
      border:1px solid rgba(255,255,255,.18);
      background:#0f1333; color:#eef1ff; box-sizing:border-box;
      /* スマホでのフォント拡大防止 */
      font-size: 16px; 
    }
    select:focus,input:focus,button:focus{outline:2px solid #6c8bff; outline-offset:1px;}
    button{cursor:pointer; transition:transform .1s,box-shadow .1s,background .15s;}
    button.primary{background:#3c5cff;border-color:#5f79ff;font-weight:700;box-shadow:0 6px 18px rgba(60,92,255,.45);}
    button.primary:active{transform:translateY(1px);box-shadow:0 3px 10px rgba(0,0,0,.4);}
    button.sub{background:#20264a;}
    button.warn{background:#ff7b5c;border-color:#ffb29e;}

    .statbox{display:grid; grid-template-columns:repeat(5,1fr); gap:10px; margin-top:10px;}
    .stat{background:#0f1435;border:1px dashed rgba(255,255,255,.15);padding:8px;border-radius:10px;font-size:12px;}
    .stat strong{display:block;font-size:11px;opacity:.7;margin-bottom:4px;}

    .prompt{margin-top:16px;font-size:18px;min-height:32px;}
    .hint{
      margin-top:10px; font-family:ui-monospace,Menlo,Consolas,monospace;
      background:#0b0f29; padding:10px; border-radius:10px;
      border:1px solid rgba(255,255,255,.08); min-height:26px; font-size:15px;
    }
    #input{margin-top:12px;font-size:16px;}
    .controls-row{margin-top:12px;display:flex;gap:10px;flex-wrap:wrap;align-items:center;}
    .controls-row > *{flex:1 1 0;}
    .controls-row .small{flex:0 0 auto;font-size:12px;white-space:nowrap;}
    #feedback{margin-top:8px;font-size:12px;opacity:.9;min-height:16px;}

    .log{margin-top:12px;background:#0f1435;border-radius:12px;border:1px solid rgba(255,255,255,.1);padding:10px;font-size:12px;max-height:200px;overflow:auto;display:none;}
    .log-entry.ok{color:#7fffb0;}
    .log-entry.ng{color:#ff9d8b;}

    .leaderboard{
      margin-top:12px; background:#0f1435; border:1px solid rgba(255,255,255,.12);
      border-radius:12px; padding:10px; font-size:12px;
    }
    .leaderboard h3{margin:0 0 6px;font-size:13px;opacity:.9;}
    .leaderboard ol{margin:0;padding-left:20px;}
    .leaderboard li{margin:2px 0;}
    .leaderboard .muted{opacity:.7;font-size:11px;}

    .overlay{position:fixed;inset:0;display:flex;align-items:center;justify-content:center;
      background:radial-gradient(circle at top,#202a5a90,#050816f0);
      backdrop-filter:blur(6px);z-index:999;opacity:0;pointer-events:none;transition:opacity .25s ease-out;}
    .overlay.visible{opacity:1;pointer-events:auto;}
    .result-card{background:#111633;border-radius:20px;padding:20px 22px;text-align:center;
      border:1px solid rgba(255,255,255,.22);box-shadow:0 24px 60px rgba(0,0,0,.7);
      min-width:300px;max-width:560px;position:relative;overflow:hidden;}
    .result-title{font-size:26px;margin-bottom:4px;}
    .result-badge{display:inline-block;margin-bottom:8px;padding:4px 10px;border-radius:999px;font-size:11px;letter-spacing:.08em;text-transform:uppercase;
      background:linear-gradient(90deg,#ffcf71,#f76b1c);color:#222;font-weight:700;}
    .result-detail{font-size:13px;opacity:.9;margin-bottom:6px;}
    .result-small{font-size:11px;opacity:.7;margin-bottom:6px;}
    .result-close{margin-top:10px;padding:7px 14px;border-radius:999px;border:1px solid rgba(255,255,255,.5);
      background:transparent;color:#fff;font-size:12px;}
    .confetti-piece{position:absolute;width:6px;height:12px;background:#ffeb3b;top:-20px;border-radius:2px;opacity:0;animation:confetti-fall 1.8s ease-out forwards;}
    @keyframes confetti-fall{0%{transform:translate3d(0,-40px,0) rotateZ(0deg);opacity:0;}10%{opacity:1;}100%{transform:translate3d(var(--dx,0),320px,0) rotateZ(360deg);opacity:0;}}

    .rubric{margin:8px auto 6px; text-align:left; font-size:12px; max-width:420px;}
    .rubric .row{display:flex;justify-content:space-between; padding:4px 8px; border-radius:8px; margin:2px 0; background:#0b1030; border:1px solid rgba(255,255,255,.08);}
    .rubric .row.active{background:linear-gradient(90deg,#22c55e22,#67e8f922); border-color:#67e8f9aa;}
    .rubric .label{font-weight:700;}
    .rubric .range{opacity:.85;}

    .lb-in-overlay{margin-top:8px;text-align:left;}
    .lb-in-overlay h4{margin:4px 0;font-size:13px;}
    .lb-in-overlay ol{margin:0;padding-left:20px;font-size:12px;}
    .lb-in-overlay li{margin:2px 0;}
    .pill{display:inline-block;padding:2px 8px;border-radius:999px;background:#0f1435;border:1px solid rgba(255,255,255,.12);font-size:11px;opacity:.85;}

    /* --- Flight mini game --- */
    .flight-wrap{
      margin: 8px 0 12px; 
      width: 100%; 
      background: #eaf6ff; 
      border-radius: 12px; 
      overflow: hidden; 
      border: 1px solid #cfe7f6;
      /* ここからスマホ対策：画面上部に固定する設定 */
      position: -webkit-sticky;
      position: sticky;
      top: 0;
      z-index: 100;
      box-shadow: 0 4px 12px rgba(0,0,0,0.3
